<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">
<link rel="import" href="/bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">
<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="/bower_components/iron-a11y-keys/iron-a11y-keys.html">


<dom-module id="wallpaper-header">
  <template>
    <style>
      .subreddit
      {
        background: orangered;
        color: white;
        font-family: RobotoDraft, 'Helvetica Neue', Helvetica, Arial;
        text-transform: none;
      }

      #refresh-button {
        background: purple;
        color: white;
        font-family: RobotoDraft, 'Helvetica Neue', Helvetica, Arial;
        text-transform: none;
      }

      #header-container
      {
         background-color:#303030;
         width: 100%;
         top: 0;
         position: fixed;
         z-index:100000;
      }

      #header
      {
         background-color:#303030;
         width: 95%;
         margin-top: 10px;
         margin-left: auto;
         margin-right: auto;
         margin-bottom: 10px;
      }

      #subreddits,
      #input,
      #selected-subreddits {
        display: inline-block;
      }

      paper-input,
      paper-dropdown-menu {
        color: white;
        --paper-input-container-label: {
          color: white;
          font-family: RobotoDraft, 'Helvetica Neue', Helvetica, Arial;
        };
        --paper-input-container-input: {
          color: white;
          font-style: normal;
          font-family: serif;
          text-transform: none;
          font-family: RobotoDraft, 'Helvetica Neue', Helvetica, Arial;
        }
        --paper-input-container-focus-color: skyblue;
      }

      #controls
      {
         margin-bottom: 10px;
         float:right;
      }

    </style>

    <div id="header-container">
       <div id="header">
          <div id="subreddits">
            <iron-a11y-keys id="a11y" target="[[inputTarget]]" keys="enter"
                    on-keys-pressed="addSubreddit"></iron-a11y-keys>
            <paper-input
                id="input"
                always-float-label label="Add a subreddit"
                value="{{subredditInput}}">
              <div prefix>/r/</div>
            </paper-input>
             <div id="selected-subreddits">
               <template is="dom-repeat" items="{{subreddits}}">
                 <paper-button raised class="subreddit" on-tap="removeSubreddit">{{item}}</paper-button>
               </template>
             </div>
          </div>

          <div id="controls">
            <paper-dropdown-menu label="Sort">
              <paper-listbox class="dropdown-content" selected="0">
                <paper-item>Hot</paper-item>
                <paper-item>Top</paper-item>
                <paper-item>New</paper-item>
              </paper-listbox>
            </paper-dropdown-menu>

            <paper-dropdown-menu label="Time">
              <paper-listbox class="dropdown-content" selected="0">
                <paper-item>Day</paper-item>
                <paper-item>Week</paper-item>
                <paper-item>Month</paper-item>
                <paper-item>Year</paper-item>
                <paper-item>All Time</paper-item>
              </paper-listbox>
            </paper-dropdown-menu>

             <paper-button raised id="refresh-button" on-tap="refresh">Refresh</paper-button>
          </div>
       </div>

       <hr width="100%" />
    </div>
  </template>

  <script>
    Polymer({
      is: 'wallpaper-header',

      properties: {
        subreddits: {
          type: Array,
          notify: true,
        },

        subredditInput: String,

        inputTarget: {
          type: Object,
          value: function() { return this.$.input; },
        },
      },

      refresh() {
        this.fire('refresh');
      },

      addSubreddit() {
        if(this.subredditInput &&
          !this.subreddits.includes(this.subredditInput)) {
          this.push('subreddits', this.subredditInput);
          this.subredditInput = "";
        }
      },

      removeSubreddit(e) {
        let index = this.subreddits.indexOf(e.model.item);
        if (index >= 0) {
          this.splice('subreddits', index, 1);
        }
      }
    });
  </script>
</dom-module>
